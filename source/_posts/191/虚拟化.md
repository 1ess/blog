---
title: 虚拟化
featured_image: https://cdn.0xfee1dead.cn/blogImg/Blog191.jpg
date: 2021-08-16
---

今天给公司搭建虚拟化平台，对其中用到的一些知识进行整理。

> 如果没有虚拟化，就不可能有云计算。而如果没有 Hypervisor，则不可能有虚拟化。

## 何为 Hypervisor
***  
在 Hypervisor 成为主流之前，大部分的物理计算机一次只能运行一个操作系统。由于计算硬件只需处理一个操作系统的请求，因此非常稳定。 但这种方法的缺点在于浪费资源，因为操作系统并不始终在使用计算机的所有计算能力。

Hypervisor 正是为了解决这一问题而生。它是一个小型软件层，支持多个操作系统相互独立地并行运行，共享相同的物理计算资源。
这些操作系统采用虚拟机(VM)的形式，也就是在软件中模拟整个计算硬件环境的文件。

Hypervisor 也称为虚拟机监控器(VMM)，用于管理这些相互独立运行的虚拟机。

Hypervisor 可以分为两种类型: TYPE I 和 TYPE II。

TYPE I 虚拟机管理器直接在底层计算机的物理硬件上运行，直接与 CPU、内存和物理存储器交互。
TYPE II 虚拟机管理器并不直接在底层硬件上运行，而是在操作系统中作为应用运行。

## 示例
***  
### VMware
- VMware ESXi: 针对数据中心内服务器虚拟化的 TYPE I 虚拟机管理器

VMware 还为台式机和笔记本电脑用户提供 2 种主要的 TYPE II 虚拟机管理器产品系列: 
- VMware Fusion: 专用于 MacOS 的产品，它使 Mac 用户能够运行大量的虚拟操作系统
- Workstation: 专注于 Linux 和 Windows 的平台

### Oracle
- VirtualBox: 在 Linux、Mac OS 和 Windows 操作系统上运行的 TYPE II 虚拟机管理器

### Hyper-V
Hyper-V 是专为 Windows 系统设计的 Microsoft 虚拟机管理器。
Microsoft 将 Hyper-V 指定为 TYPE I 虚拟机管理器，即使它与许多竞争对手产品的运行方式不同。 Hyper-V 安装在 Windows 上，但直接在物理硬件上运行，将自身插入主机操作系统之下。 

### OpenSource Hypervisor
某些虚拟机管理器来自开源项目，例如:
- KVM: Red Hat 是该解决方案的长期支持者，基于内核的虚拟机(KVM)在 2007 年成为 Linux 内核主线的一部分
- Xen: 它是在 Intel 和 ARM 架构上运行的开源 TYPE I 虚拟机管理器，源自剑桥大学的一个项目

## 公司虚拟化平台
*** 
公司新买的 DELL 服务器今天到了，要搭建虚拟化平台，由于自己对 ESXi 比较熟悉，因此决定采用该软件进行平台搭建。

### 安装
新买的服务器有三块 3T 磁盘，我们先对服务器磁盘进行 RAID5，DELL 服务器 RAID 操作非常简单，使用 F2 进入系统设置，选择 Device Setting，选中 RAID 卡，然后进行 Configuration Managerment，选择 Create Virtual Disk 根据磁盘数量创建可使用的 RAID 类型。

然后我们使用 rufus 将 ESXi 写入 U 盘制作启动盘，以 U 盘启动后，则可进入 DCUI。我们可以拿着显示器和键盘直接连接服务器对其进行 IP 等基础配置。配置完毕，我们以后就可以直接使用 VMware Host Client 远程管理了。

### 创建虚拟机
创建虚拟机前，我们要先在存储中上载对应操作系统的镜像文件，创建虚拟机过程非常简单，在此不再赘述。

### vSphere 网络
目前看来 vSphere 的网络比较简单，存在 vSwitch0 连接内外网络，默认有两个端口组，一个是管理端口组，一个是虚拟机端口组，均使用默认虚拟交换机进行网络连接，比较直观。